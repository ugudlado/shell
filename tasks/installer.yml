- name: Install Ansible collection
  shell: ansible-galaxy collection install community.general
  delegate_to: localhost
  register: result
  until: result is succeeded
  retries: 5
  delay: 10
  when: ansible_distribution == "MacOSX"

- name: Install packages with apt
  ansible.builtin.apt:
    name:
      - git
      - tmux
      - zsh
      - fzf
      - direnv
      - stow
      - docker
    state: present
  when: ansible_distribution == "Ubuntu"

- name: Install packages with brew
  community.general.homebrew:
    name:
      - git
      - tmux
      - zsh
      - fzf
      - direnv
      - stow
      - docker
    state: present
  when: ansible_distribution == "MacOSX"

- name: Install packages with brew cask
  community.general.homebrew_cask:
    name:
      - iterm2
      - visual-studio-code
      - font-fira-code
    state: present
  when: ansible_distribution == "MacOSX"

- name: Download nvm install script
  get_url:
    url: https://raw.githubusercontent.com/nvm-sh/nvm/v0.38.0/install.sh
    dest: /tmp/nvm_install.sh
    mode: "0755"

- name: Install nvm
  shell: bash /tmp/nvm_install.sh

- name: Install npm
  package:
    name: npm
    state: present
- name: Install terminalizer
  npm:
    name: terminalizer
    global: yes
